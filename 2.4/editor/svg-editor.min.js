function svg_edit_setup(){var aw={invalidAttrValGiven:"Invalid value given",noContentToFitTo:"No content to fit to",layer:"Layer",dupeLayerName:"There is already a layer named that!",enterUniqueLayerName:"Please enter a unique layer name",enterNewLayerName:"Please enter the new layer name",layerHasThatName:"Layer already has that name",QmoveElemsToLayer:"Move selected elements to layer '%s'?",QwantToClear:"Do you want to clear the drawing?\nThis will also erase your undo history!",QerrorsRevertToSource:"There were parsing errors in your SVG source.\nRevert back to original SVG source?",QignoreSourceChanges:"Ignore changes made to SVG source?",featNotSupported:"Feature not supported",enterNewImgURL:"Enter the new image URL",ok:"OK",cancel:"Cancel",key_up:"Up",key_down:"Down",key_backspace:"Backspace",key_del:"Del"};var X=["#000000","#202020","#404040","#606060","#808080","#a0a0a0","#c0c0c0","#e0e0e0","#ffffff","#800000","#ff0000","#808000","#ffff00","#008000","#00ff00","#008080","#00ffff","#000080","#0000ff","#800080","#ff00ff","#2b0000","#550000","#800000","#aa0000","#d40000","#ff0000","#ff2a2a","#ff5555","#ff8080","#ffaaaa","#ffd5d5","#280b0b","#501616","#782121","#a02c2c","#c83737","#d35f5f","#de8787","#e9afaf","#f4d7d7","#241c1c","#483737","#6c5353","#916f6f","#ac9393","#c8b7b7","#e3dbdb","#2b1100","#552200","#803300","#aa4400","#d45500","#ff6600","#ff7f2a","#ff9955","#ffb380","#ffccaa","#ffe6d5","#28170b","#502d16","#784421","#a05a2c","#c87137","#d38d5f","#deaa87","#e9c6af","#f4e3d7","#241f1c","#483e37","#6c5d53","#917c6f","#ac9d93","#c8beb7","#e3dedb","#2b2200","#554400","#806600","#aa8800","#d4aa00","#ffcc00","#ffd42a","#ffdd55","#ffe680","#ffeeaa","#fff6d5","#28220b","#504416","#786721","#a0892c","#c8ab37","#d3bc5f","#decd87","#e9ddaf","#f4eed7","#24221c","#484537","#6c6753","#918a6f","#aca793","#c8c4b7","#e3e2db","#222b00","#445500","#668000","#88aa00","#aad400","#ccff00","#d4ff2a","#ddff55","#e5ff80","#eeffaa","#f6ffd5","#22280b","#445016","#677821","#89a02c","#abc837","#bcd35f","#cdde87","#dde9af","#eef4d7","#22241c","#454837","#676c53","#8a916f","#a7ac93","#c4c8b7","#e2e3db","#112b00","#225500","#338000","#44aa00","#55d400","#66ff00","#7fff2a","#99ff55","#b3ff80","#ccffaa","#e5ffd5","#17280b","#2d5016","#447821","#5aa02c","#71c837","#8dd35f","#aade87","#c6e9af","#e3f4d7","#1f241c","#3e4837","#5d6c53","#7c916f","#9dac93","#bec8b7","#dee3db","#002b00","#005500","#008000","#00aa00","#00d400","#00ff00","#2aff2a","#55ff55","#80ff80","#aaffaa","#d5ffd5","#0b280b","#165016","#217821","#2ca02c","#37c837","#5fd35f","#87de87","#afe9af","#d7f4d7","#1c241c","#374837","#536c53","#6f916f","#93ac93","#b7c8b7","#dbe3db","#002b11","#005522","#008033","#00aa44","#00d455","#00ff66","#2aff80","#55ff99","#80ffb3","#aaffcc","#d5ffe6","#0b2817","#16502d","#217844","#2ca05a","#37c871","#5fd38d","#87deaa","#afe9c6","#d7f4e3","#1c241f","#37483e","#536c5d","#6f917c","#93ac9d","#b7c8be","#dbe3de","#002b22","#005544","#008066","#00aa88","#00d4aa","#00ffcc","#2affd5","#55ffdd","#80ffe6","#aaffee","#d5fff6","#0b2822","#165044","#217867","#2ca089","#37c8ab","#5fd3bc","#87decd","#afe9dd","#d7f4ee","#1c2422","#374845","#536c67","#6f918a","#93aca7","#b7c8c4","#dbe3e2","#00222b","#004455","#006680","#0088aa","#00aad4","#00ccff","#2ad4ff","#55ddff","#80e5ff","#aaeeff","#d5f6ff","#0b2228","#164450","#216778","#2c89a0","#37abc8","#5fbcd3","#87cdde","#afdde9","#d7eef4","#1c2224","#374548","#53676c","#6f8a91","#93a7ac","#b7c4c8","#dbe2e3","#00112b","#002255","#003380","#0044aa","#0055d4","#0066ff","#2a7fff","#5599ff","#80b3ff","#aaccff","#d5e5ff","#0b1728","#162d50","#214478","#2c5aa0","#3771c8","#5f8dd3","#87aade","#afc6e9","#d7e3f4","#1c1f24","#373e48","#535d6c","#6f7c91","#939dac","#b7bec8","#dbdee3","#00002b","#000055","#000080","#0000aa","#0000d4","#0000ff","#2a2aff","#5555ff","#8080ff","#aaaaff","#d5d5ff","#0b0b28","#161650","#212178","#2c2ca0","#3737c8","#5f5fd3","#8787de","#afafe9","#d7d7f4","#1c1c24","#373748","#53536c","#6f6f91","#9393ac","#b7b7c8","#dbdbe3","#11002b","#220055","#330080","#4400aa","#5500d4","#6600ff","#7f2aff","#9955ff","#b380ff","#ccaaff","#e5d5ff","#170b28","#2d1650","#442178","#5a2ca0","#7137c8","#8d5fd3","#aa87de","#c6afe9","#e3d7f4","#1f1c24","#3e3748","#5d536c","#7c6f91","#9d93ac","#beb7c8","#dedbe3","#22002b","#440055","#660080","#8800aa","#aa00d4","#cc00ff","#d42aff","#dd55ff","#e580ff","#eeaaff","#f6d5ff","#220b28","#441650","#672178","#892ca0","#ab37c8","#bc5fd3","#cd87de","#ddafe9","#eed7f4","#221c24","#453748","#67536c","#8a6f91","#a793ac","#c4b7c8","#e2dbe3","#2b0022","#550044","#800066","#aa0088","#d400aa","#ff00cc","#ff2ad4","#ff55dd","#ff80e5","#ffaaee","#ffd5f6","#280b22","#501644","#782167","#a02c89","#c837ab","#d35fbc","#de87cd","#e9afdd","#f4d7ee","#241c22","#483745","#6c5367","#916f8a","#ac93a7","#c8b7c4","#e3dbe2","#2b0011","#550022","#800033","#aa0044","#d40055","#ff0066","#ff2a7f","#ff5599","#ff80b2","#ffaacc","#ffd5e5","#280b17","#50162d","#782144","#a02c5a","#c83771","#d35f8d","#de87aa","#e9afc6","#f4d7e3","#241c1f","#48373e","#6c535d","#916f7c","#ac939d","#c8b7be","#e3dbde"];var ah=false;var I="";var at=new SvgCanvas(document.getElementById("svgcanvas"));var ac=at.pathActions;var x="images/logo.png";$.pref=function(bl,bg){if(bg){az[bl]=bg}bl="svg-edit-"+bl;var bm=location.hostname;var i=bm&&bm.indexOf(".")!=-1;var bk=(bg!=undefined);var bh=false;try{if(window.localStorage&&i){bh=localStorage}}catch(bi){}try{if(window.globalStorage&&i){bh=globalStorage[bm]}}catch(bi){}if(bh){if(bk){bh.setItem(bl,bg)}else{return bh.getItem(bl)}}else{if(window.widget){if(bk){widget.setPreferenceForKey(bg,bl)}else{return widget.preferenceForKey(bl)}}else{if(bk){var bj=new Date();bj.setTime(bj.getTime()+31536000000);bg=encodeURIComponent(bg);document.cookie=bl+"="+bg+"; expires="+bj.toUTCString()}else{var bn=document.cookie.match(new RegExp(bl+"=([^;]+)"));return bn?decodeURIComponent(bn[1]):""}}}};var az={lang:"en",iconsize:"m",bg_color:"#FFF",bg_url:"",img_save:"embed"};(function(){$("#dialog_container").draggable({cancel:"#dialog_content, #dialog_buttons *"});var bh=$("#dialog_box"),i=$("#dialog_buttons");var bg=function(bk,bm,bn,bl){$("#dialog_content").html("<p>"+bm.replace(/\n/g,"</p><p>")+"</p>").toggleClass("prompt",(bk=="prompt"));i.empty();var bj=$('<input type="button" value="'+aw.ok+'">').appendTo(i);if(bk!="alert"){$('<input type="button" value="'+aw.cancel+'">').appendTo(i).click(function(){bh.hide();bn(false)})}if(bk=="prompt"){var bi=$('<input type="text">').prependTo(i);bi.val(bl||"");bi.bind("keydown",{combi:"return"},function(){bj.click()})}bh.show();bj.click(function(){bh.hide();var bo=(bk=="prompt")?bi.val():true;if(bn){bn(bo)}}).focus();if(bk=="prompt"){bi.focus()}};$.alert=function(bj,bi){bg("alert",bj,bi)};$.confirm=function(bj,bi){bg("confirm",bj,bi)};$.prompt=function(bk,bj,bi){bg("prompt",bk,bi,bj)}}());var aa=function(){$(".tool_button_current").removeClass("tool_button_current").addClass("tool_button");$("#tool_select").addClass("tool_button_current");$("#styleoverrides").text("#svgcanvas svg *{cursor:move;pointer-events:all} #svgcanvas svg{cursor:default}");at.setMode("select")};var J=1250;var a5=false;var aX=null;var aH=false;var ap=false;var a0=false;var am=["x","y","x1","x2","y1","y2","cx","cy","width","height","r","rx","ry","width","height","radius"];var O=["em","ex","px","cm","mm","in","pt","pc","%"];var l=new $.jGraduate.Paint({solidColor:"FF0000"});var R=new $.jGraduate.Paint({solidColor:"000000"});var a8=function(bg,i){bg.open("data:image/svg+xml;base64,"+Utils.encode64(i))};var aN=function(bi,bg){aX=(bg.length==1||bg[1]==null?bg[0]:null);aH=(bg.length>=2&&bg[1]!=null);var i=false;if(aX!=null){i=!!(aX.id&&aX.id.indexOf("pathpointgrip")==0);if(at.getMode()!="multiselect"&&!i){aa();E()}}$("#path_node_panel").toggle(i);$("#tools_bottom_2,#tools_bottom_3").toggle(!i);var bh=$("#tool_select > svg, #tool_select > img")[0].getAttribute("width");if(i){$(".tool_button").removeClass("tool_button_current");$("#tool_select").addClass("tool_button_current").empty().append($.getSvgIcon("select_node"))}else{$("#tool_select").empty().append($.getSvgIcon("select"))}$.resizeSvgIcons({"#tool_select .svg_icon":bh});aG()};var aT=function(bk,bg){for(var bh=0;bh<bg.length;++bh){var bj=bg[bh];if(bj&&bj.tagName=="svg"&&bj.getAttribute("viewBox")){var bi=bj.getAttribute("viewBox").split(" ");bd(parseInt(bi[2]),parseInt(bi[3]))}else{if(bj&&aX&&aX.parentNode==null){aX=bj}}}aG()};var af=function(){var bh=$("#background_img");if(!bh.length){return}var i=bh.find("img");var bg=at.getZoom();i.width(bg*100+"%")};var ag=function(bl,bp){var bj=15;var bn=at.getResolution();var bg=$("#workarea");var bk=$("#svgcanvas").position();bg.css("cursor","auto");var bh=at.setBBoxZoom(bp,bg.width()-bj,bg.height()-bj);if(!bh){return}var bi=bh.zoom;var bm=bh.bbox;$("#zoom").val(Math.round(bi*100));e(bn.w*bi,bn.h*bi);var i=bm.x*bi;var br=bg.width()/2-(bm.width*bi)/2;bg[0].scrollLeft=Math.max(0,i-br)+Math.max(0,bk.left);var bo=bm.y*bi;var bq=bg.height()/2-(bm.height*bi)/2;bg[0].scrollTop=Math.max(0,bo-bq)+Math.max(0,bk.top);if(at.getMode()=="zoom"&&bm.width){aa()}aR()};var E=function(){if(aX!=null&&aX.tagName!="image"&&aX.tagName!="g"){var i=parseFloat(aX.getAttribute("fill-opacity"));if(isNaN(i)){i=1}var bh=parseFloat(aX.getAttribute("stroke-opacity"));if(isNaN(bh)){bh=1}var bk=aX.getAttribute("fill")||"none";at.setFillColor(bk,true);at.setFillOpacity(i,true);var bj=aX.getAttribute("stroke")||"none";at.setStrokeColor(bj,true);at.setStrokeOpacity(bh,true);i*=100;bh*=100;var bg=function(bl,bn){var bm=null;if(bl.substr(0,5)=="url(#"){bm={alpha:bn,linearGradient:document.getElementById(bl.substr(5,bl.length-6))}}else{if(bl.substr(0,1)=="#"){bm={alpha:bn,solidColor:bl.substr(1)}}}return new $.jGraduate.Paint(bm)};l=bg(bk,i);R=bg(bj,bh);i=i+" %";bh=bh+" %";if(bk=="none"){i="N/A"}document.getElementById("gradbox_fill").parentNode.firstChild.setAttribute("fill",bk);if(bj==null||bj==""||bj=="none"){bj="none";bh="N/A"}document.getElementById("gradbox_stroke").parentNode.firstChild.setAttribute("fill",bj);$("#fill_opacity").html(i);$("#stroke_opacity").html(bh);$("#stroke_width").val(aX.getAttribute("stroke-width")||1);$("#stroke_style").val(aX.getAttribute("stroke-dasharray")||"none")}if(aX!=null){var bi=((aX.getAttribute("opacity")||1)*100);$("#group_opacity").val(bi);$("#opac_slider").slider("option","value",bi)}F()};var aG=function(){var bu=aX;if(bu!=null&&!bu.parentNode){bu=null}var br=at.getCurrentLayer();var i=at.getMode();if(i=="rotate"&&bu!=null){var bv=at.getRotationAngle(bu);$("#angle").val(bv);$("#tool_reorient").toggleClass("tool_button_disabled",bv==0);return}var bh=bu?(bu.id&&bu.id.indexOf("pathpointgrip")==0):false;$("#selected_panel, #multiselected_panel, #g_panel, #rect_panel, #circle_panel,			#ellipse_panel, #line_panel, #text_panel, #image_panel").hide();if(bu!=null){var bw=bu.nodeName;var bt=at.getRotationAngle(bu);$("#angle").val(bt);if(at.addedNew){if(bw=="image"){D()}else{if(bw=="text"){}}}if(!bh&&i!="pathedit"){$("#selected_panel").show();if($.inArray(bw,["line","circle","ellipse"])!=-1){$("#xy_panel").hide()}else{var bo,bn;if($.inArray(bw,["g","polyline","path"])!=-1){var bj=at.getStrokedBBox([bu]);if(bj){bo=bj.x;bn=bj.y}}else{bo=bu.getAttribute("x");bn=bu.getAttribute("y")}$("#selected_x").val(bo||0);$("#selected_y").val(bn||0);$("#xy_panel").show()}var bk=$.inArray(bw,["image","text","path","g"])==-1;$("#tool_topath").toggle(bk);$("#tool_reorient").toggle(bw=="path");$("#tool_reorient").toggleClass("tool_button_disabled",bt==0)}else{var bq=ac.getNodePoint();if(bq){var bm=$("#seg_type");$("#path_node_x").val(bq.x);$("#path_node_y").val(bq.y);if(bq.type){bm.val(bq.type).removeAttr("disabled")}else{bm.val(4).attr("disabled","disabled")}}return}var bg={g:[],rect:["rx","width","height"],image:["width","height"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],line:["x1","y1","x2","y2"],text:[]};var bl=bu.tagName;if(bg[bl]){var bi=bg[bl];$("#"+bl+"_panel").show();$.each(bi,function(bx,by){$("#"+bl+"_"+by).val(bu.getAttribute(by)||0)});if(bl=="text"){$("#text_panel").css("display","inline");if(at.getItalic()){$("#tool_italic").addClass("tool_button_current")}else{$("#tool_italic").removeClass("tool_button_current")}if(at.getBold()){$("#tool_bold").addClass("tool_button_current")}else{$("#tool_bold").removeClass("tool_button_current")}$("#font_family").val(bu.getAttribute("font-family"));$("#font_size").val(bu.getAttribute("font-size"));$("#text").val(bu.textContent);if(at.addedNew){$("#text").focus().select()}}else{if(bl=="image"){var bp="http://www.w3.org/1999/xlink";var bs=bu.getAttributeNS(bp,"href");aP(bs)}}}}else{if(aH){$("#multiselected_panel").show()}}if(at.getUndoStackSize()>0){$("#tool_undo").removeClass("tool_button_disabled")}else{$("#tool_undo").addClass("tool_button_disabled")}if(at.getRedoStackSize()>0){$("#tool_redo").removeClass("tool_button_disabled")}else{$("#tool_redo").addClass("tool_button_disabled")}at.addedNew=false;if((bu&&!bh)||aH){$("#selLayerNames").removeAttr("disabled").val(br)}else{$("#selLayerNames").attr("disabled","disabled")}};$("#text").focus(function(){a5=true});$("#text").blur(function(){a5=false});at.bind("selected",aN);at.bind("changed",aT);at.bind("saved",a8);at.bind("zoomed",ag);var a9='<div class="palette_item" data-rgb="none"></div>';$.each(X,function(bg,bh){a9+='<div class="palette_item" style="background-color: '+bh+';" data-rgb="'+bh+'"></div>'});$("#palette").append(a9);var aD=["#FFF","#888","#000","url(data:image/gif;base64,R0lGODlhEAAQAIAAAP%2F%2F%2F9bW1iH5BAAAAAAALAAAAAAQABAAAAIfjG%2Bgq4jM3IFLJgpswNly%2FXkcBpIiVaInlLJr9FZWAQA7)"];var a9="";$.each(aD,function(){a9+='<div class="color_block" style="background:'+this+';"></div>'});$("#bg_blocks").append(a9);var aK=$("#bg_blocks div");var a6="cur_background";aK.each(function(){var i=$(this);i.click(function(){aK.removeClass(a6);$(this).addClass(a6)})});if($.pref("bg_color")){V($.pref("bg_color"),$.pref("bg_url"))}if($.pref("img_save")){az.img_save=$.pref("img_save");$("#image_save_opts input").val([az.img_save])}var aU=$("#tools_rect_show").position();$("#tools_rect").css({left:aU.left+4,top:aU.top+77});aU=$("#tools_ellipse_show").position();$("#tools_ellipse").css({left:aU.left+4,top:aU.top+77});var a1=function(i){at.setRectRadius(i.value)};var al=function(i){at.setFontSize(i.value)};var aZ=function(i){var bg=i.value;if(bg==0&&aX&&$.inArray(aX.nodeName,["line","polyline"])!=-1){bg=i.value=1}at.setStrokeWidth(bg)};var y=function(i){at.setRotationAngle(i.value);$("#tool_reorient").toggleClass("tool_button_disabled",i.value==0)};var bf=function(i){var bg=i.value/100;var bh=at.getZoom();var bi=$("#workarea");ag(window,{width:0,height:0,x:(bi[0].scrollLeft+bi.width()/2)/bh,y:(bi[0].scrollTop+bi.height()/2)/bh,zoom:bg})};var aA=function(i,bg){if(bg==null){bg=i.value}$("#group_opacity").val(bg);if(!i||!i.handle){$("#opac_slider").slider("option","value",bg)}at.setOpacity(bg/100)};$("#stroke_style").change(function(){at.setStrokeStyle(this.options[this.selectedIndex].value)});$("select").change(function(){$(this).blur()});var aB=false;$("#selLayerNames").change(function(){var bh=this.options[this.selectedIndex].value;var bg=aw.QmoveElemsToLayer.replace("%s",bh);var i=function(bi){if(!bi){return}aB=true;at.moveSelectedToLayer(bh);at.clearSelection();B()};if(bh){if(aB){i(true)}else{$.confirm(bg,i)}}});$("#font_family").change(function(){at.setFontFamily(this.value)});$("#seg_type").change(function(){at.setSegType($(this).val())});$("#text").keyup(function(){at.setTextContent(this.value)});$("#image_url").change(function(){aP(this.value)});$(".attr_changer").change(function(){var i=this.getAttribute("data-attr");var bh=this.value;var bg=false;if($.inArray(i,am)!=-1){if(!isNaN(bh)){bg=true}else{}}else{bg=true}if(!bg){$.alert(aw.invalidAttrValGiven);this.value=aX.getAttribute(i);return false}at.changeSelectedAttribute(i,bh)});$("#palette").mouseover(function(){var i=$('<input type="hidden">');$(this).append(i);i.focus().remove()});$(".palette_item").click(function(i){var bi=(i.shiftKey?"stroke":"fill");var bk=(i.shiftKey?"#stroke_":"#fill_");var bh=$(this).attr("data-rgb");var bg=document.getElementById("gradbox_"+bi).parentNode.firstChild;var bj=null;if(bh=="transparent"||bh=="initial"){bh="none";$(bk+"opacity").html("N/A");bj=new $.jGraduate.Paint()}else{bj=new $.jGraduate.Paint({alpha:100,solidColor:bh.substr(1)})}bg.setAttribute("fill",bh);if(i.shiftKey){R=bj;if(at.getStrokeColor()!=bh){at.setStrokeColor(bh)}if(bh!="none"&&at.getStrokeOpacity()!=1){at.setStrokeOpacity(1);$("#stroke_opacity").html("100 %")}}else{l=bj;if(at.getFillColor()!=bh){at.setFillColor(bh)}if(bh!="none"&&at.getFillOpacity()!=1){at.setFillOpacity(1);$("#fill_opacity").html("100 %")}}F()});var S=function(bg,i){if($(bg).hasClass("tool_button_disabled")){return false}var i=i||"normal";$(".tools_flyout").fadeOut(i);$("#styleoverrides").text("");$(".tool_button_current").removeClass("tool_button_current").addClass("tool_button");$(bg).addClass("tool_button_current");at.clearSelection();return true};var h=function(bi,bk,bh){var bg=$(bi).find("button");var bj=$(bi).find("ul");var i=false;if(bh){$(bi).addClass("dropup")}$(bi).find("li").bind("mouseup",bk);$().mouseup(function(bl){if(!i){bg.removeClass("down");bj.hide()}i=false});bg.bind("mousedown",function(){if(!bg.hasClass("down")){bg.addClass("down");bj.show();i=true}else{bg.removeClass("down");bj.hide()}}).hover(function(){i=true}).mouseout(function(){i=false})};h("#font_family_dropdown",function(){var i=$(this).text();$("#font_family").val($(this).text()).change()});h("#opacity_dropdown",function(){if($(this).find("div").length){return}var i=parseInt($(this).text().split("%")[0]);aA(false,i)});$("#opac_slider").slider({start:function(){$("#opacity_dropdown li:not(.special)").hide()},stop:function(){$("#opacity_dropdown li").show()},slide:function(i,bg){aA(bg)}});h("#zoom_dropdown",function(){var i=$(this);var bg=i.attr("data-val");if(bg){ag(window,bg)}else{bf({value:parseInt(i.text())})}},true);var ax=function(bh,bi){var bg=$.getSvgIcon(bi).clone();var i=$(bh);bg[0].setAttribute("width",i.width());bg[0].setAttribute("height",i.height());i.empty().append(bg)};var T=function(){if(S("#tool_select")){at.setMode("select");$("#styleoverrides").text("#svgcanvas svg *{cursor:move;pointer-events:all}, #svgcanvas svg{cursor:default}")}};var aj=function(){if(S("#tool_fhpath")){at.setMode("fhpath")}};var au=function(){if(S("#tool_line")){at.setMode("line")}};var q=function(){if(S("#tools_rect_show",J)){J="normal";at.setMode("square")}ax("#tools_rect_show","square")};var aq=function(){if(S("#tools_rect_show")){at.setMode("rect")}ax("#tools_rect_show","rect")};var s=function(){if(S("#tools_rect_show")){at.setMode("fhrect")}ax("#tools_rect_show","fh_rect")};var d=function(){if(S("#tools_ellipse_show",J)){J="normal";at.setMode("circle")}ax("#tools_ellipse_show","circle")};var Q=function(){if(S("#tools_ellipse_show")){at.setMode("ellipse")}ax("#tools_ellipse_show","ellipse")};var ad=function(){if(S("#tools_ellipse_show")){at.setMode("fhellipse")}ax("#tools_ellipse_show","fh_ellipse")};var aS=function(){if(S("#tool_image")){at.setMode("image")}};var an=function(){if(S("#tool_zoom")){$("#workarea").css("cursor","crosshair");at.setMode("zoom")}};var H=function(){if(S("#tool_zoom")){c();aa()}};var z=function(){S("#tool_text");at.setMode("text")};var bb=function(){S("#tool_path");at.setMode("path")};var g=function(){if(aX!=null||aH){at.deleteSelectedElements()}};var k=function(){if(aX!=null){at.moveToTopSelectedElement()}};var L=function(){if(aX!=null){at.moveToBottomSelectedElement()}};var m=function(){if(aX!=null){at.convertToPath()}};var A=function(){if(aX!=null){ac.reorient()}};var r=function(bg,i){if(aX!=null||aH){at.moveSelectedElements(bg,i)}};var N=function(){$("#tool_node_link").toggleClass("push_button_pressed");var i=$("#tool_node_link").hasClass("push_button_pressed");ac.linkControlPoints(i)};var U=function(){if(ac.getNodePoint()){ac.clonePathNode()}};var aM=function(){if(ac.getNodePoint()){ac.deletePathNode()}};var aV=function(){at.cycleElement(1)};var ao=function(){at.cycleElement(0)};var j=function(i){if(aX==null||aH){return}var bh=5;if(!i){bh*=-1}var bg=$("#angle").val()*1+bh;at.setRotationAngle(bg);aG()};var aE=function(){$.confirm(aw.QwantToClear,function(i){if(!i){return}at.clear();at.setResolution(640,480);c();B();aG()})};var ab=function(){at.setBold(!at.getBold());aG()};var ay=function(){at.setItalic(!at.getItalic());aG()};var aJ=function(){var i={images:az.img_save,round_digits:6};at.save(i)};var aW=function(){at.open()};var C=function(){if(at.getUndoStackSize()>0){at.undo();B()}};var Z=function(){if(at.getRedoStackSize()>0){at.redo();B()}};var ai=function(){if(aH){at.groupSelectedElements()}else{if(aX&&aX.tagName=="g"){at.ungroupSelectedElement()}}};var K=function(){at.cloneSelectedElements()};var b=function(){var i=this.id.replace("tool_align","").charAt(0);at.alignSelectedElements(i,$("#align_relative_to").val())};var c=function(bg){var i=at.getResolution();bg=bg?i.zoom*bg:1;e(i.w*bg,i.h*bg,true);$("#zoom").val(bg*100);at.setZoom(bg);aR()};var aR=function(){af();P()};var ak=function(){$("#tool_wireframe").toggleClass("push_button_pressed");$("#workarea").toggleClass("wireframe");if(M){return}var i=$("#wireframe_rules");if(!i.length){i=$('<style id="wireframe_rules"></style>').appendTo("head")}else{i.empty()}P()};var P=function(){if(M){return}var i="#workarea.wireframe #svgcontent * { stroke-width: "+1/at.getZoom()+"px; }";$("#wireframe_rules").text($("#workarea").hasClass("wireframe")?i:"")};var o=function(){if(ap){return}ap=true;var i=at.getSvgString();$("#svg_source_textarea").val(i);$("#svg_source_editor").fadeIn();n();$("#svg_source_textarea").focus()};$("#svg_docprops_container").draggable({cancel:"button,fieldset"});var aC=function(){if(a0){return}a0=true;$("#image_save_opts input").val([az.img_save]);var bg=at.getResolution();$("#canvas_width").val(bg.w);$("#canvas_height").val(bg.h);$("#canvas_title").val(at.getImageTitle());var bj=$("#bg_blocks div");var bi="cur_background";var bh=$("#svgcanvas").css("background");var i=bh.match(/url\("?(.*?)"?\)/);if(i){i=i[1]}bj.each(function(){var bk=$(this);var bl=bk.css("background")==bh;bk.toggleClass(bi,bl);if(bl){$("#canvas_bg_url").removeClass(bi)}});if(!bh){bj.eq(0).addClass(bi)}if(!$("#bg_blocks ."+bi).length&&i){$("#canvas_bg_url").val(i)}$("#svg_docprops").fadeIn()};var n=function(){var i=$("#svg_source_container").height()-80;$("#svg_source_textarea").css("height",i)};var aY=function(){if(!ap){return}var i=function(){at.clearSelection();a7();c();B();ba(at.getImageTitle())};if(!at.setSvgString($("#svg_source_textarea").val())){$.confirm(aw.QerrorsRevertToSource,function(bg){if(!bg){return false}i()})}else{i()}aa()};var ba=function(bh){var i=$("title:first").text().split(":")[0];var bg=i+(bh?": "+bh:"");$("title:first").text(bg)};var ar=function(){var bh=$("#canvas_title").val();ba(bh);at.setImageTitle(bh);var i=parseInt($("#canvas_width").val());var bj=parseInt($("#canvas_height").val());if(isNaN(i)||isNaN(bj)){i="fit"}if(!at.setResolution(i,bj)){$.alert(aw.noContentToFitTo);return false}az.img_save=$("#image_save_opts :checked").val();$.pref("img_save",az.img_save);var bg=$("#bg_blocks div.cur_background").css("background")||"#FFF";V(bg,$("#canvas_bg_url").val());var bi=$("#lang_select").val();if(bi!=az.lang){put_locale(at,bi)}aF($("#iconsize").val());aI()};function V(i,bg){if(i==az.bg_color&&bg==az.bg_url){return}$.pref("bg_color",i);$.pref("bg_url",bg);$("#svgcanvas").css("background",i);if(bg){if(!$("#background_img").length){$('<div id="background_img"><img src="'+bg+'" style="width:100%"></div>').prependTo("#svgcanvas")}else{$("#background_img img").attr("src",bg)}}else{$("#background_img").remove()}}var aF=function(bi){if(bi==az.size){return}$.pref("iconsize",bi);$("#iconsize").val(bi);var bg={s:16,m:24,l:32,xl:48};var bk=bg[bi];$(".tool_button, .push_button, .tool_button_current, .tool_button_disabled, .tool_flyout_button, #url_notice").find("> svg, > img").each(function(){this.setAttribute("width",bk);this.setAttribute("height",bk)});$.resizeSvgIcons({".flyout_arrow_horiz svg, .flyout_arrow_horiz img":bk/3,"#logo a > svg, #logo a > img":bk*1.3});if(bi!="s"){$.resizeSvgIcons({"#layerbuttons svg, #layerbuttons img":bk*0.6})}var bj={".tool_button,			.push_button,			.tool_button_current,			.tool_button_disabled,			#tools_rect .tool_flyout_button,			#tools_ellipse .tool_flyout_button":{width:{s:"16px",l:"32px",xl:"48px"},height:{s:"16px",l:"32px",xl:"48px"},padding:{s:"1px",l:"2px",xl:"3px"}},".tool_sep":{height:{s:"16px",l:"32px",xl:"48px"},margin:{s:"2px 2px",l:"2px 5px",xl:"2px 8px"}},"#tools_top":{left:{s:"27px",l:"50px",xl:"70px"},height:{s:"50px",l:"88px",xl:"125px"}},"#tools_left":{width:{s:"26px",l:"34px",xl:"42px"},top:{s:"50px",l:"87px",xl:"125px"}},"div#workarea":{left:{s:"27px",l:"46px",xl:"65px"},top:{s:"50px",l:"88px",xl:"125px"},bottom:{s:"51px",l:"68px",xl:"75px"}},"#tools_bottom":{left:{s:"27px",l:"46px",xl:"65px"},height:{s:"52px",l:"68px",xl:"75px"}},"#tools_top input, #tools_bottom input":{"margin-top":{s:"2px",l:"4px",xl:"5px"},height:{s:"auto",l:"auto",xl:"auto"},border:{s:"1px solid #555",l:"auto",xl:"auto"},"font-size":{s:".9em",l:"2em",xl:"2.5em"}},"#zoom_panel":{"margin-top":{s:"3px",l:"4px",xl:"5px"}},"#copyright, #tools_bottom .label":{"font-size":{l:"1.5em",xl:"2em"},"line-height":{s:"15px"}},"#tools_bottom_2":{width:{l:"295px",xl:"355px"}},"#tools_top > div, #tools_top":{"line-height":{s:"17px",l:"34px",xl:"50px"}},"div.toolset":{height:{s:"25px",l:"43px",xl:"64px"}},".dropdown button":{height:{s:"18px",l:"34px",xl:"40px"},"line-height":{s:"18px",l:"34px",xl:"40px"},"margin-top":{s:"3px"}},"#tools_top label, #tools_bottom label":{"font-size":{s:"1em",l:"1.5em",xl:"2em"},"margin-top":{s:"1px",l:"3px",xl:"5px"}},"#tool_bold, #tool_italic":{"font-size":{s:"1.5em",l:"3em",xl:"4.5em"}},"#sidepanels":{top:{s:"50px",l:"88px",xl:"125px"},bottom:{s:"51px",l:"68px",xl:"65px"}},"#layerbuttons":{width:{l:"130px",xl:"175px"},height:{l:"24px",xl:"30px"}},"#layerlist":{width:{l:"128px",xl:"150px"}},".layer_button":{width:{l:"19px",xl:"28px"},height:{l:"19px",xl:"28px"}},".flyout_arrow_horiz":{left:{s:"-5px",l:"5px",xl:"14px"},top:{s:"-13px",l:"-13px",xl:"-20px"}},"input.spin-button":{"background-image":{l:"url('images/spinbtn_updn_big.png')",xl:"url('images/spinbtn_updn_big.png')"},"background-position":{l:"100% -5px",xl:"100% -2px"},"padding-right":{l:"24px",xl:"24px"}},"input.spin-button.up":{"background-position":{l:"100% -45px",xl:"100% -42px"}},"input.spin-button.down":{"background-position":{l:"100% -85px",xl:"100% -82px"}}};var i=$("#tool_size_rules");if(!i.length){i=$('<style id="tool_size_rules"></style>').appendTo("head")}else{i.empty()}if(bi!="m"){var bh="";$.each(bj,function(bm,bn){bm="#svg_editor "+bm.replace(/,/g,", #svg_editor");bh+=bm+"{";$.each(bn,function(bp,bo){if(bo[bi]){bh+=(bp+":"+bo[bi]+";")}});bh+="}"});i.text(bh)}var bl=$("#tools_rect_show").offset();$("#tools_rect").css({left:bl.left,top:bl.top});bl=$("#tools_ellipse_show").offset();$("#tools_ellipse").css({left:bl.left,top:bl.top})};var av=function(){$("#dialog_box").hide();if(!ap&&!a0){return}if(ap){var i=at.getSvgString();if(i!=$("#svg_source_textarea").val()){$.confirm(aw.QignoreSourceChanges,function(bg){if(bg){a7()}})}else{a7()}}else{if(a0){aI()}}};var a7=function(){$("#svg_source_editor").hide();ap=false;$("#svg_source_textarea").blur()};var aI=function(){$("#svg_docprops").hide();$("#canvas_width,#canvas_height").removeAttr("disabled");$("#resolution")[0].selectedIndex=0;$("#image_save_opts input").val([az.img_save]);a0=false};$(window).resize(function(i){if(!ap){return}n()});$("#url_notice").click(function(){$.alert(this.title)});$("#change_image_url").click(D);function D(){$.prompt(aw.enterNewImgURL,x,function(i){if(i){aP(i)}})}function aP(i){if(!i){i=x}at.setImageURL(i);$("#image_url").val(i);if(i.indexOf("data:")===0){$("#image_url").hide();$("#change_image_url").show()}else{at.embedImage(i,function(bg){if(!bg){$("#url_notice").show()}else{$("#url_notice").hide()}x=i});$("#image_url").show();$("#change_image_url").hide()}}(function(){var bh=["clear","open","save","source","delete","delete_multi","paste","clone","clone_multi","move_top","move_bottom"];var i="";var bg="tool_button_current";$.each(bh,function(bi,bj){i+="#tool_"+bj+(bi==bh.length-1?",":"")});$(i).mousedown(function(){$(this).addClass(bg)}).bind("mousedown mouseout",function(){$(this).removeClass(bg)});$("#tool_undo, #tool_redo").mousedown(function(){if(!$(this).hasClass("tool_button_disabled")){$(this).addClass(bg)}}).bind("mousedown mouseout",function(){$(this).removeClass(bg)})}());$("#workarea").bind("mousewheel DOMMouseScroll",function(bg){if(!bg.shiftKey){return}bg.preventDefault();var bi=$("#svgcanvas").offset();var i=at.getZoom();var bh={x:(bg.pageX-bi.left)/i,y:(bg.pageY-bi.top)/i,width:0,height:0};if(bg.wheelDelta){if(bg.wheelDelta>=120){bh.factor=2}else{if(bg.wheelDelta<=-120){bh.factor=0.5}}}else{if(bg.detail){if(bg.detail>0){bh.factor=0.5}else{if(bg.detail<0){bh.factor=2}}}}if(!bh.factor){return}ag(window,bh)});if(ah){var G=["tool_clear","tool_save","tool_source","tool_undo","tool_redo","tool_clone"];var W=G.length;while(W--){var f=document.getElementById(G[W]);var p=f.title;var a4=p.indexOf("Ctrl+");f.title=[p.substr(0,a4),"Cmd+",p.substr(a4+5)].join("")}}var aQ=function(bh){var bg=bh.attr("id")=="stroke_color"?"stroke":"fill";var i=(bg=="stroke"?$("#stroke_opacity"):$("#fill_opacity"));var bk=(bg=="stroke"?R:l);var bj=(bg=="stroke"?"Pick a Stroke Paint and Opacity":"Pick a Fill Paint and Opacity");var bi=false;if(bk.type=="none"){bk=new $.jGraduate.Paint({solidColor:"ffffff"});bi=true}var bl=bh.position();$("#color_picker").draggable({cancel:".jPicker_table,.jGraduate_lgPick"}).css({left:bl.left,bottom:50-bl.top}).jGraduate({paint:bk,window:{pickerTitle:bj},images:{clientPath:"jgraduate/images/"}},function(bq){bk=new $.jGraduate.Paint(bq);var bo=document.getElementById("gradbox_"+bg);var bp=bo.parentNode;var bn=bp.firstChild;if(bk.type=="linearGradient"){bp.removeChild(bo);var bm=bp.appendChild(document.importNode(bk.linearGradient,true));at.fixOperaXML(bm,bk.linearGradient);bm.id="gradbox_"+bg;bn.setAttribute("fill","url(#gradbox_"+bg+")")}else{bn.setAttribute("fill","#"+bk.solidColor)}i.html(bk.alpha+" %");if(bg=="stroke"){at.setStrokePaint(bk,true)}else{at.setFillPaint(bk,true)}E();$("#color_picker").hide()},function(bm){$("#color_picker").hide()})};var F=function(){var i=(at.getFillColor()=="none");var bg=(at.getStrokeColor()=="none");var bj=["#tool_path","#tool_line"];var bi=["#tools_rect_show","#tools_ellipse_show","#tool_text"];if(bg){for(a4 in bj){var bh=bj[a4];if($(bh).hasClass("tool_button_current")){T()}$(bh).removeClass("tool_button").addClass("tool_button_disabled")}}else{for(a4 in bj){var bh=bj[a4];$(bh).removeClass("tool_button_disabled").addClass("tool_button")}}if(bg&&i){for(a4 in bi){var bh=bi[a4];if($(bh).hasClass("tool_button_current")){T()}$(bh).removeClass("tool_button").addClass("tool_button_disabled")}}else{for(a4 in bi){var bh=bi[a4];$(bh).removeClass("tool_button_disabled").addClass("tool_button")}}if(window.opera){$("<p/>").hide().appendTo("body").remove()}};var t=new DOMParser().parseFromString('<svg xmlns="http://www.w3.org/2000/svg"><rect width="100%" height="100%" fill="#FF0000"/>		<linearGradient id="gradbox_">				<stop stop-color="#000" offset="0.0"/>				<stop stop-color="#FF0000" offset="1.0"/>		</linearGradient></svg>',"text/xml");var be=t.getElementById("gradbox_");be.id="gradbox_fill";t.documentElement.setAttribute("width",16.5);$("#fill_color").append(document.importNode(t.documentElement,true));be.id="gradbox_stroke";t.documentElement.setAttribute("width",16.5);$(t.documentElement.firstChild).attr("fill","#000000");$("#stroke_color").append(document.importNode(t.documentElement,true));var Y=t.documentElement.firstChild;Y.setAttribute("style","vector-effect:non-scaling-stroke");var M=(Y.style.vectorEffect=="non-scaling-stroke");Y.removeAttribute("style");setTimeout(function(){at.embedImage("images/logo.png",function(i){if(!i){$("#image_save_opts [value=embed]").attr("disabled","disabled");$("#image_save_opts input").val(["ref"]);az.img_save="ref";$("#image_opt_embed").css("color","#666").attr("title",aw.featNotSupported)}})},1000);$("#fill_color").click(function(){aQ($(this));F()});$("#stroke_color").click(function(){aQ($(this));F()});$("#tools_rect_show").mousedown(function(i){$("#tools_rect").show();i.preventDefault()});$("#tools_rect").mouseleave(function(){$("#tools_rect").fadeOut()});$("#tool_move_top").mousedown(function(i){$("#tools_stacking").show();i.preventDefault()});$("#tools_ellipse_show").mousedown(function(i){$("#tools_ellipse").show();i.preventDefault()});$("#tools_ellipse").mouseleave(function(){$("#tools_ellipse").fadeOut()});$(".tool_flyout_button").mouseover(function(){$(this).addClass("tool_flyout_button_current")}).mouseout(function(){$(this).removeClass("tool_flyout_button_current")});$(".layer_button").mousedown(function(){$(this).addClass("layer_buttonpressed")}).mouseout(function(){$(this).removeClass("layer_buttonpressed")}).mouseup(function(){$(this).removeClass("layer_buttonpressed")});$(".push_button").mousedown(function(){if(!$(this).hasClass("tool_button_disabled")){$(this).addClass("push_button_pressed")}}).mouseout(function(){$(this).removeClass("push_button_pressed")}).mouseup(function(){$(this).removeClass("push_button_pressed")});$("#layer_new").click(function(){var bj=new Array(at.getNumLayers());for(var bh=0;bh<bj.length;++bh){bj[bh]=at.getLayer(bh)}var bg=(bj.length+1);var bi=aw.layer+" "+bg;while($.inArray(bi,bj)!=-1){bg++;bi=aw.layer+" "+bg}$.prompt(aw.enterUniqueLayerName,bi,function(i){if(!i){return}if($.inArray(i,bj)!=-1){$.alert(aw.dupeLayerName);return}at.createLayer(i);aG();B();$("#layerlist tr.layer").removeClass("layersel");$("#layerlist tr.layer:first").addClass("layersel")})});$("#layer_delete").click(function(){if(at.deleteCurrentLayer()){aG();B();$("#layerlist tr.layer").removeClass("layersel");$("#layerlist tr.layer:first").addClass("layersel")}});$("#layer_up").click(function(){var i=$("#layerlist tr.layersel").prevAll().length;if(i>0){var bg=$("#layerlist tr.layer").length;i--;at.setCurrentLayerPosition(bg-i-1);B();$("#layerlist tr.layer").removeClass("layersel");$("#layerlist tr.layer:eq("+i+")").addClass("layersel")}});$("#layer_down").click(function(){var i=$("#layerlist tr.layersel").prevAll().length;var bg=$("#layerlist tr.layer").length;if(i<bg-1){i++;at.setCurrentLayerPosition(bg-i-1);B();$("#layerlist tr.layer").removeClass("layersel");$("#layerlist tr.layer:eq("+i+")").addClass("layersel")}});$("#layer_rename").click(function(){var i=$("#layerlist tr.layersel").prevAll().length;var bg=$("#layerlist tr.layersel td.layername").text();$.prompt(aw.enterNewLayerName,"",function(bh){if(!bh){return}if(bg==bh){$.alert(aw.layerHasThatName);return}var bj=new Array(at.getNumLayers());for(var bi=0;bi<bj.length;++bi){bj[bi]=at.getLayer(bi)}if($.inArray(bh,bj)!=-1){$.alert(aw.layerHasThatName);return}at.renameCurrentLayer(bh);B();$("#layerlist tr.layer").removeClass("layersel");$("#layerlist tr.layer:eq("+i+")").addClass("layersel")})});var a=300;var ae=150;var v=-1,w=false;$("#sidepanel_handle").mousedown(function(i){v=i.pageX}).mouseup(function(i){if(!w){aO()}v=-1;w=false});$("#svg_editor").mouseup(function(){v=-1}).mouseout(function(i){if(v==-1){return}if(i.pageX>this.clientWidth){v=-1;aO(true)}}).mousemove(function(i){if(v==-1){return}w=true;var bg=v-i.pageX;var bk=$("#sidepanels");var bi=parseInt(bk.css("width"));if(bi+bg>a){bg=a-bi;bi=a}else{if(bi+bg<2){bg=2-bi;bi=2}}if(bg==0){return}v-=bg;var bh=$("#workarea");var bj=$("#layerpanel");bh.css("right",parseInt(bh.css("right"))+bg);bk.css("width",parseInt(bk.css("width"))+bg);bj.css("width",parseInt(bj.css("width"))+bg);bc()});var aO=function(bk){var i=parseInt($("#sidepanels").css("width"));var bg=(i>2||bk?2:ae)-i;var bh=$("#workarea");var bj=$("#sidepanels");var bi=$("#layerpanel");bh.css("right",parseInt(bh.css("right"))+bg);bj.css("width",parseInt(bj.css("width"))+bg);bi.css("width",parseInt(bi.css("width"))+bg);bc()};var u=function(bg){var bi=new Array(at.getNumLayers());for(var bh=0;bh<bi.length;++bh){bi[bh]=at.getLayer(bh)}if(bg){for(var bh=0;bh<bi.length;++bh){if(bi[bh]!=bg){at.setLayerOpacity(bi[bh],0.5)}}}else{for(var bh=0;bh<bi.length;++bh){at.setLayerOpacity(bi[bh],1)}}};var B=function(){var bl=$("#layerlist tbody");var bk=$("#selLayerNames");bl.empty();bk.empty();var bn=at.getCurrentLayer();var bi=at.getNumLayers();var bm=$.getSvgIcon("eye");while(bi--){var bg=at.getLayer(bi);var bj='<tr class="layer';if(bg==bn){bj+=" layersel"}bj+='">';if(at.getLayerVisibility(bg)){bj+='<td class="layervis"/><td class="layername" >'+bg+"</td></tr>"}else{bj+='<td class="layervis layerinvis"/><td class="layername" >'+bg+"</td></tr>"}bl.append(bj);bk.append('<option value="'+bg+'">'+bg+"</option>")}if(bm!==undefined){var i=bm.clone();$("td.layervis",bl).append(bm.clone());$.resizeSvgIcons({"td.layervis .svg_icon":14})}$("#layerlist td.layername").click(function(bo){$("#layerlist tr.layer").removeClass("layersel");var bp=$(this.parentNode);bp.addClass("layersel");at.setCurrentLayer(this.textContent);bo.preventDefault()}).mouseover(function(bo){$(this).css({"font-style":"italic",color:"blue"});u(this.textContent)}).mouseout(function(bo){$(this).css({"font-style":"normal",color:"black"});u()});$("#layerlist td.layervis").click(function(bo){var br=$(this.parentNode).prevAll().length;var bp=$("#layerlist tr.layer:eq("+br+") td.layername").text();var bq=$(this).hasClass("layerinvis");at.setLayerVisibility(bp,bq);if(bq){$(this).removeClass("layerinvis")}else{$(this).addClass("layerinvis")}});var bh=5-$("#layerlist tr.layer").size();while(bh-->0){bl.append('<tr><td style="color:white">_</td><td/></tr>')}};B();function bd(i,bh){var bg=at.getResolution().zoom;e(i*bg,bh*bg)}var bc=function(){var bg={w:parseInt($("#workarea").css("width")),h:parseInt($("#workarea").css("height"))};var i={w:parseInt($("#svgcanvas").css("width")),h:parseInt($("#svgcanvas").css("height"))};if(bg.w>i.w){$("#svgcanvas").css({left:(bg.w-i.w)/2})}if(bg.h>i.h){$("#svgcanvas").css({top:(bg.h-i.h)/2})}};$(window).resize(bc);function a2(bi,bh){var i=bi.value-0;var bg=i+bh;var bj=bg>=i;if(bh===0){return i}if(i>=24){if(bj){return Math.round(i*1.1)}else{return Math.round(i/1.1)}}else{if(i<=1){if(bj){return i*2}else{return i/2}}else{return bg}}}function a3(bi,bh){var i=bi.value-0;if(i===0){return 100}var bg=i+bh;if(bh===0){return i}if(i>=100){return bg}else{if(bg>=i){return i*2}else{return i/2}}}function e(bg,bj,i){bg-=0;bj-=0;$("#svgcanvas").css({width:bg,height:bj});$("#canvas_width").val(bg);$("#canvas_height").val(bj);bc();if(i){var bk=$("#workarea");var bh=bj/2-bk.height()/2;var bi=bg/2-bk.width()/2;bk[0].scrollTop=bh;bk[0].scrollLeft=bi}}$("#resolution").change(function(){var i=$("#canvas_width,#canvas_height");if(!this.selectedIndex){if($("#canvas_width").val()=="fit"){i.removeAttr("disabled").val(100)}}else{if(this.value=="content"){i.val("fit").attr("disabled","disabled")}else{var bg=this.value.split("x");$("#canvas_width").val(bg[0]);$("#canvas_height").val(bg[1]);i.removeAttr("disabled")}}});$("input,select").attr("autocomplete","off");var aL=function(){var bg=[{sel:"#tool_select",fn:T,evt:"click",key:1},{sel:"#tool_fhpath",fn:aj,evt:"click",key:2},{sel:"#tool_line",fn:au,evt:"click",key:3},{sel:"#tool_square",fn:q,evt:"mouseup",key:"Shift+4"},{sel:"#tool_rect",fn:aq,evt:"mouseup",key:4},{sel:"#tool_fhrect",fn:s,evt:"mouseup"},{sel:"#tool_circle",fn:d,evt:"mouseup",key:"Shift+5"},{sel:"#tool_ellipse",fn:Q,evt:"mouseup",key:5},{sel:"#tool_fhellipse",fn:ad,evt:"mouseup"},{sel:"#tool_path",fn:bb,evt:"click",key:6},{sel:"#tool_text",fn:z,evt:"click",key:7},{sel:"#tool_image",fn:aS,evt:"mouseup",key:8},{sel:"#tool_zoom",fn:an,evt:"mouseup",key:9},{sel:"#tool_clear",fn:aE,evt:"click",key:[I+"N",true]},{sel:"#tool_save",fn:function(){ap?aY():aJ()},evt:"click",key:[I+"S",true]},{sel:"#tool_open",fn:aW,evt:"click",key:[I+"O",true]},{sel:"#tool_source",fn:o,evt:"click",key:["U",true]},{sel:"#tool_wireframe",fn:ak,evt:"click",key:["F",true]},{sel:"#tool_source_cancel,#svg_source_overlay,#tool_docprops_cancel",fn:av,evt:"click",key:["esc",false,false],hidekey:true},{sel:"#tool_source_save",fn:aY,evt:"click"},{sel:"#tool_docprops_save",fn:ar,evt:"click"},{sel:"#tool_docprops",fn:aC,evt:"click",key:[I+"I",true]},{sel:"#tool_delete,#tool_delete_multi",fn:g,evt:"click",key:["del/backspace",true]},{sel:"#tool_reorient",fn:A,evt:"click"},{sel:"#tool_node_link",fn:N,evt:"click"},{sel:"#tool_node_clone",fn:U,evt:"click"},{sel:"#tool_node_delete",fn:aM,evt:"click"},{sel:"#tool_move_top",fn:k,evt:"click",key:"shift+up"},{sel:"#tool_move_bottom",fn:L,evt:"click",key:"shift+down"},{sel:"#tool_topath",fn:m,evt:"click"},{sel:"#tool_undo",fn:C,evt:"click",key:[I+"Z",true]},{sel:"#tool_redo",fn:Z,evt:"click",key:[I+"Y",true]},{sel:"#tool_clone,#tool_clone_multi",fn:K,evt:"click",key:[I+"C",true]},{sel:"#tool_group",fn:ai,evt:"click",key:[I+"G",true]},{sel:"#tool_ungroup",fn:ai,evt:"click"},{sel:"[id^=tool_align]",fn:b,evt:"click"},{sel:"#tools_rect_show",fn:aq,evt:"click"},{sel:"#tools_ellipse_show",fn:Q,evt:"click"},{sel:"#tool_bold",fn:ab,evt:"mousedown"},{sel:"#tool_italic",fn:ay,evt:"mousedown"},{sel:"#sidepanel_handle",fn:aO,key:[I+"X"]},{key:"shift+left",fn:function(){j(0)}},{key:"shift+right",fn:function(){j(1)}},{key:"shift+O",fn:ao},{key:"shift+P",fn:aV},{key:["ctrl+up",true],fn:function(){c(2)}},{key:["ctrl+down",true],fn:function(){c(0.5)}},{key:["up",true],fn:function(){r(0,-1)}},{key:["down",true],fn:function(){r(0,1)}},{key:["left",true],fn:function(){r(-1,0)}},{key:["right",true],fn:function(){r(1,0)}}];var i={"4/Shift+4":"#tools_rect_show","5/Shift+5":"#tools_ellipse_show"};return{setAll:function(){$.each(bg,function(bl,bh){if(bh.sel){var bj=$(bh.sel);if(bh.evt){bj[bh.evt](bh.fn)}}if(bh.key){var bm,bk="",bi=true,bo=bh.fn,bn=false;if($.isArray(bh.key)){bm=bh.key[0];if(bh.key.length>1){bn=bh.key[1]}if(bh.key.length>2){bi=bh.key[2]}}else{bm=bh.key}bm+="";$.each(bm.split("/"),function(br,bq){$(document).bind("keydown",{combi:bq,disableInInput:bi},function(bs){bo();if(bn){bs.preventDefault()}return false})});if(bh.sel&&!bh.hidekey){var bp=bj.attr("title").split("[")[0]+"["+bm+"]";i[bm]=bh.sel;bj.attr("title",bp)}}});$(".attr_changer, #image_url").bind("keydown",{combi:"return"},function(bh){$(this).change();bh.preventDefault()});$("#tool_zoom").dblclick(H)},setTitles:function(){$.each(i,function(bh,bi){$(bi).each(function(){var bk=this.title.split(" [")[0];var bj="";$.each(bh.split("/"),function(bo,bn){var bl=bn.split("+"),bm="";if(bl.length>1){bm=bl[0]+"+";bn=bl[1]}bj+=(bo?"/":"")+bm+(aw["key_"+bn]||bn)});this.title=bk+" ["+bj+"]"})})}}}();aL.setAll();$("#rect_rx").SpinButton({min:0,max:1000,step:1,callback:a1});$("#stroke_width").SpinButton({min:0,max:99,step:1,callback:aZ});$("#angle").SpinButton({min:-180,max:180,step:5,callback:y});$("#font_size").SpinButton({step:1,min:0.001,stepfunc:a2,callback:al});$("#group_opacity").SpinButton({step:5,min:0,max:100,callback:aA});$("#zoom").SpinButton({min:0.001,max:10000,step:50,stepfunc:a3,callback:bf});at.setIconSize=aF;at.setLang=function(bh,i){az.lang=bh;$.pref("lang",bh);$("#lang_select").val(bh);if(i){var bi=$("#layerlist tr.layersel td.layername").text();var bg=(bi==aw.layer+" 1");$.extend(aw,i);at.setUiStrings(i);aL.setTitles();if(bg){at.renameCurrentLayer(aw.layer+" 1");B()}}};at.populateLayers=B;at.setCustomHandlers=function(i){if(i.open){$("#tool_open").show();at.bind("opened",function(bg,bh){i.open(bh);this.populateLayers()})}if(i.save){at.bind("saved",i.save)}};e(640,480);return at}(function(){$.svgIcons("images/svg_edit_icons.svg",{w:24,h:24,id_match:false,no_img:true,fallback_path:"images/",fallback:{new_image:"clear.png",save:"save.png",open:"open.png",source:"source.png",docprops:"document-properties.png",wireframe:"wireframe.png",undo:"undo.png",redo:"redo.png",select:"select.png",select_node:"select_node.png",pencil:"fhpath.png",pen:"line.png",square:"square.png",rect:"rect.png",fh_rect:"freehand-square.png",circle:"circle.png",ellipse:"ellipse.png",fh_ellipse:"freehand-circle.png",path:"path.png",text:"text.png",image:"image.png",zoom:"zoom.png",clone:"clone.png","delete":"delete.png",group:"shape_group.png",ungroup:"shape_ungroup.png",move_top:"move_top.png",move_bottom:"move_bottom.png",to_path:"to_path.png",link_controls:"link_controls.png",reorient:"reorient.png",align_left:"align-left.png",align_center:"align-center",align_right:"align-right",align_top:"align-top",align_middle:"align-middle",align_bottom:"align-bottom",go_up:"go-up.png",go_down:"go-down.png",ok:"save.png",cancel:"cancel.png",arrow_right:"flyouth.png",arrow_down:"dropdown.gif"},placement:{"#logo a":"logo","#tool_clear,#layer_new":"new_image","#tool_save":"save","#tool_open":"open","#tool_source":"source","#tool_docprops":"docprops","#tool_wireframe":"wireframe","#tool_undo":"undo","#tool_redo":"redo","#tool_select":"select","#tool_fhpath":"pencil","#tool_line":"pen","#tool_rect,#tools_rect_show":"rect","#tool_square":"square","#tool_fhrect":"fh_rect","#tool_ellipse,#tools_ellipse_show":"ellipse","#tool_circle":"circle","#tool_fhellipse":"fh_ellipse","#tool_path":"path","#tool_text,#layer_rename":"text","#tool_image":"image","#tool_zoom":"zoom","#tool_clone,#tool_clone_multi,#tool_node_clone":"clone","#layer_delete,#tool_delete,#tool_delete_multi,#tool_node_delete":"delete","#tool_move_top":"move_top","#tool_move_bottom":"move_bottom","#tool_topath":"to_path","#tool_node_link":"link_controls","#tool_reorient":"reorient","#tool_group":"group","#tool_ungroup":"ungroup","#tool_alignleft":"align_left","#tool_aligncenter":"align_center","#tool_alignright":"align_right","#tool_aligntop":"align_top","#tool_alignmiddle":"align_middle","#tool_alignbottom":"align_bottom","#url_notice":"warning","#layer_up":"go_up","#layer_down":"go_down","#layerlist td.layervis":"eye","#tool_source_save,#tool_docprops_save":"ok","#tool_source_cancel,#tool_docprops_cancel":"cancel",".flyout_arrow_horiz":"arrow_right",".dropdown button":"arrow_down","#palette .palette_item:first, #fill_bg, #stroke_bg":"no_color"},resize:{"#logo a .svg_icon":32,".flyout_arrow_horiz .svg_icon":5,".layer_button .svg_icon, #layerlist td.layervis .svg_icon":14,".dropdown button .svg_icon":7,".palette_item:first .svg_icon, #fill_bg .svg_icon, #stroke_bg .svg_icon":16,".toolbar_button button .svg_icon":16},callback:function(d){$(".toolbar_button button > svg, .toolbar_button button > img").each(function(){$(this).parent().prepend(this)});var a=$("#tools_left");var b=a.offset().top+a.outerHeight();var c=$.pref("iconsize");if(c&&c!="m"){svgCanvas.setIconSize(c)}else{if($(window).height()<b){svgCanvas.setIconSize("s")}}var g=document.location.href;if(g.indexOf("?source=")!=-1){var e="?source=data:image/svg+xml;base64,";var f=g.substring(g.indexOf(e)+e.length);svgCanvas.setSvgString(Utils.decode64(f))}}})}());$(function(){svgCanvas=svg_edit_setup();put_locale(svgCanvas);try{json_encode=function(obj){if(window.JSON&&JSON.stringify){return JSON.stringify(obj)}var enc=arguments.callee;if(typeof obj=="boolean"||typeof obj=="number"){return obj+""}else{if(typeof obj=="string"){return'"'+obj.replace(/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"'}else{if(obj.length){for(var i=0;i<obj.length;i++){obj[i]=enc(obj[i])}return"["+obj.join(",")+"]"}else{var pairs=[];for(var k in obj){pairs.push(enc(k)+":"+enc(obj[k]))}return"{"+pairs.join(",")+"}"}}}};window.addEventListener("message",function(e){var cbid=parseInt(e.data.substr(0,e.data.indexOf(";")));try{e.source.postMessage("SVGe"+cbid+";"+json_encode(eval(e.data)),e.origin)}catch(err){e.source.postMessage("SVGe"+cbid+";error:"+err.message,e.origin)}},false)}catch(err){window.embed_error=err}});