if(!window.console){window.console=new function(){this.log=function(a){};this.dir=function(a){}}}var palette=["#000000","#202020","#404040","#606060","#808080","#a0a0a0","#c0c0c0","#e0e0e0","#ffffff","#800000","#ff0000","#808000","#ffff00","#008000","#00ff00","#008080","#00ffff","#000080","#0000ff","#800080","#ff00ff","#2b0000","#550000","#800000","#aa0000","#d40000","#ff0000","#ff2a2a","#ff5555","#ff8080","#ffaaaa","#ffd5d5","#280b0b","#501616","#782121","#a02c2c","#c83737","#d35f5f","#de8787","#e9afaf","#f4d7d7","#241c1c","#483737","#6c5353","#916f6f","#ac9393","#c8b7b7","#e3dbdb","#2b1100","#552200","#803300","#aa4400","#d45500","#ff6600","#ff7f2a","#ff9955","#ffb380","#ffccaa","#ffe6d5","#28170b","#502d16","#784421","#a05a2c","#c87137","#d38d5f","#deaa87","#e9c6af","#f4e3d7","#241f1c","#483e37","#6c5d53","#917c6f","#ac9d93","#c8beb7","#e3dedb","#2b2200","#554400","#806600","#aa8800","#d4aa00","#ffcc00","#ffd42a","#ffdd55","#ffe680","#ffeeaa","#fff6d5","#28220b","#504416","#786721","#a0892c","#c8ab37","#d3bc5f","#decd87","#e9ddaf","#f4eed7","#24221c","#484537","#6c6753","#918a6f","#aca793","#c8c4b7","#e3e2db","#222b00","#445500","#668000","#88aa00","#aad400","#ccff00","#d4ff2a","#ddff55","#e5ff80","#eeffaa","#f6ffd5","#22280b","#445016","#677821","#89a02c","#abc837","#bcd35f","#cdde87","#dde9af","#eef4d7","#22241c","#454837","#676c53","#8a916f","#a7ac93","#c4c8b7","#e2e3db","#112b00","#225500","#338000","#44aa00","#55d400","#66ff00","#7fff2a","#99ff55","#b3ff80","#ccffaa","#e5ffd5","#17280b","#2d5016","#447821","#5aa02c","#71c837","#8dd35f","#aade87","#c6e9af","#e3f4d7","#1f241c","#3e4837","#5d6c53","#7c916f","#9dac93","#bec8b7","#dee3db","#002b00","#005500","#008000","#00aa00","#00d400","#00ff00","#2aff2a","#55ff55","#80ff80","#aaffaa","#d5ffd5","#0b280b","#165016","#217821","#2ca02c","#37c837","#5fd35f","#87de87","#afe9af","#d7f4d7","#1c241c","#374837","#536c53","#6f916f","#93ac93","#b7c8b7","#dbe3db","#002b11","#005522","#008033","#00aa44","#00d455","#00ff66","#2aff80","#55ff99","#80ffb3","#aaffcc","#d5ffe6","#0b2817","#16502d","#217844","#2ca05a","#37c871","#5fd38d","#87deaa","#afe9c6","#d7f4e3","#1c241f","#37483e","#536c5d","#6f917c","#93ac9d","#b7c8be","#dbe3de","#002b22","#005544","#008066","#00aa88","#00d4aa","#00ffcc","#2affd5","#55ffdd","#80ffe6","#aaffee","#d5fff6","#0b2822","#165044","#217867","#2ca089","#37c8ab","#5fd3bc","#87decd","#afe9dd","#d7f4ee","#1c2422","#374845","#536c67","#6f918a","#93aca7","#b7c8c4","#dbe3e2","#00222b","#004455","#006680","#0088aa","#00aad4","#00ccff","#2ad4ff","#55ddff","#80e5ff","#aaeeff","#d5f6ff","#0b2228","#164450","#216778","#2c89a0","#37abc8","#5fbcd3","#87cdde","#afdde9","#d7eef4","#1c2224","#374548","#53676c","#6f8a91","#93a7ac","#b7c4c8","#dbe2e3","#00112b","#002255","#003380","#0044aa","#0055d4","#0066ff","#2a7fff","#5599ff","#80b3ff","#aaccff","#d5e5ff","#0b1728","#162d50","#214478","#2c5aa0","#3771c8","#5f8dd3","#87aade","#afc6e9","#d7e3f4","#1c1f24","#373e48","#535d6c","#6f7c91","#939dac","#b7bec8","#dbdee3","#00002b","#000055","#000080","#0000aa","#0000d4","#0000ff","#2a2aff","#5555ff","#8080ff","#aaaaff","#d5d5ff","#0b0b28","#161650","#212178","#2c2ca0","#3737c8","#5f5fd3","#8787de","#afafe9","#d7d7f4","#1c1c24","#373748","#53536c","#6f6f91","#9393ac","#b7b7c8","#dbdbe3","#11002b","#220055","#330080","#4400aa","#5500d4","#6600ff","#7f2aff","#9955ff","#b380ff","#ccaaff","#e5d5ff","#170b28","#2d1650","#442178","#5a2ca0","#7137c8","#8d5fd3","#aa87de","#c6afe9","#e3d7f4","#1f1c24","#3e3748","#5d536c","#7c6f91","#9d93ac","#beb7c8","#dedbe3","#22002b","#440055","#660080","#8800aa","#aa00d4","#cc00ff","#d42aff","#dd55ff","#e580ff","#eeaaff","#f6d5ff","#220b28","#441650","#672178","#892ca0","#ab37c8","#bc5fd3","#cd87de","#ddafe9","#eed7f4","#221c24","#453748","#67536c","#8a6f91","#a793ac","#c4b7c8","#e2dbe3","#2b0022","#550044","#800066","#aa0088","#d400aa","#ff00cc","#ff2ad4","#ff55dd","#ff80e5","#ffaaee","#ffd5f6","#280b22","#501644","#782167","#a02c89","#c837ab","#d35fbc","#de87cd","#e9afdd","#f4d7ee","#241c22","#483745","#6c5367","#916f8a","#ac93a7","#c8b7c4","#e3dbe2","#2b0011","#550022","#800033","#aa0044","#d40055","#ff0066","#ff2a7f","#ff5599","#ff80b2","#ffaacc","#ffd5e5","#280b17","#50162d","#782144","#a02c5a","#c83771","#d35f8d","#de87aa","#e9afc6","#f4d7e3","#241c1f","#48373e","#6c535d","#916f7c","#ac939d","#c8b7be","#e3dbde"];function svg_edit_setup(){var d=new SvgCanvas(document.getElementById("svgcanvas"));var a=function(){$(".tool_button_current").removeClass("tool_button_current").addClass("tool_button");$("#tool_select").addClass("tool_button_current");$("#styleoverrides").text("*{cursor:move;pointer-events:all} svg{cursor:default}");d.setMode("select")};var H=false;var p=null;var J=false;var C=function(M,L){p=(L.length==1||L[1]==null?L[0]:null);J=(L.length>=2&&L[1]!=null);if(p!=null){if(d.getMode()!="multiselect"){a()}x()}l(true)};var B=function(O,L){for(var M=0;M<L.length;++M){var N=L[M];if(N&&N.tagName=="svg"){j(parseInt(N.getAttribute("width")),parseInt(N.getAttribute("height")))}}l(false)};function x(){if(p!=null){var L=parseFloat(p.getAttribute("fill-opacity"));if(isNaN(L)){L=1}L=(L*100)+" %";var M=parseFloat(p.getAttribute("stroke-opacity"));if(isNaN(M)){M=1}M=(M*100)+" %";var O=p.getAttribute("fill");d.setFillColor(O);if(O=="none"){O="url('images/none.png')";L="N/A"}$("#fill_color").css("background",O);var N=p.getAttribute("stroke");d.setStrokeColor(N);if(N==null||N==""||N=="none"){N="url('images/none.png')";M="N/A"}$("#stroke_color").css("background",N);$("#fill_opacity").html(L);$("#stroke_opacity").html(M);$("#group_opacity").val(((p.getAttribute("opacity")||1)*100)+" %");$("#stroke_width").val(p.getAttribute("stroke-width")||1);$("#stroke_style").val(p.getAttribute("stroke-dasharray")||"none")}n()}function l(L){var M=p;$("#selected_panel").hide();$("#multiselected_panel").hide();$("#rect_panel").hide();$("#circle_panel").hide();$("#ellipse_panel").hide();$("#line_panel").hide();$("#text_panel").hide();if(M!=null){$("#selected_panel").show();switch(M.tagName){case"rect":$("#rect_panel").show();$("#rect_radius").val(M.getAttribute("rx")||0);$("#rect_x").val(M.getAttribute("x")||0);$("#rect_y").val(M.getAttribute("y")||0);$("#rect_w").val(M.getAttribute("width")||0);$("#rect_h").val(M.getAttribute("height")||0);break;case"circle":$("#circle_panel").show();$("#circle_cx").val(M.getAttribute("cx")||0);$("#circle_cy").val(M.getAttribute("cy")||0);$("#circle_r").val(M.getAttribute("r")||0);break;case"ellipse":$("#ellipse_panel").show();$("#ellipse_cx").val(M.getAttribute("cx")||0);$("#ellipse_cy").val(M.getAttribute("cy")||0);$("#ellipse_rx").val(M.getAttribute("rx")||0);$("#ellipse_ry").val(M.getAttribute("ry")||0);break;case"line":$("#line_panel").show();$("#line_x1").val(M.getAttribute("x1")||0);$("#line_y1").val(M.getAttribute("y1")||0);$("#line_x2").val(M.getAttribute("x2")||0);$("#line_y2").val(M.getAttribute("y2")||0);break;case"text":$("#text_panel").show().css("display","inline");if(d.getItalic()){$("#tool_italic").addClass("tool_button_current")}else{$("#tool_italic").removeClass("tool_button_current")}if(d.getBold()){$("#tool_bold").addClass("tool_button_current")}else{$("#tool_bold").removeClass("tool_button_current")}$("#font_family").val(M.getAttribute("font-family"));$("#font_size").val(M.getAttribute("font-size"));$("#text").val(M.textContent);$("#text").focus();if(L){$("#text").select()}break}}else{if(J){$("#multiselected_panel").show()}}if(d.getUndoStackSize()>0){$("#tool_undo").removeClass("tool_button_disabled")}else{$("#tool_undo").addClass("tool_button_disabled")}if(d.getRedoStackSize()>0){$("#tool_redo").removeClass("tool_button_disabled")}else{$("#tool_redo").addClass("tool_button_disabled")}}$("#text").focus(function(){H=true});$("#text").blur(function(){H=false});d.bind("selected",C);d.bind("changed",B);var t='<div class="palette_item" style="background: url(\'images/none.png\');"></div>';$.each(palette,function(L,M){t+='<div class="palette_item" style="background: '+M+';"></div>'});$("#palette").append(t);var r=$("#tools_rect_show").position();$("#tools_rect").css({left:r.left+4,top:r.top+70});r=$("#tools_ellipse_show").position();$("#tools_ellipse").css({left:r.left+4,top:r.top+70});function F(L){d.setStrokeWidth(L.value)}$("#stroke_style").change(function(){d.setStrokeStyle(this.options[this.selectedIndex].value)});$("#group_opacity").change(function(){d.setOpacity(this.options[this.selectedIndex].value)});$("#font_size").change(function(){d.setFontSize(this.options[this.selectedIndex].value)});$("#font_family").change(function(){d.setFontFamily(this.options[this.selectedIndex].value)});$("#text").keyup(function(){d.setTextContent(this.value)});function q(L){d.setRectRadius(L.value)}$(".attr_changer").change(function(){d.changeSelectedAttribute(this.getAttribute("alt"),this.value)});$(".palette_item").click(function(L){var M=(L.shiftKey?"#stroke_":"#fill_");color=$(this).css("background-color");if(color=="transparent"||color=="initial"){color="none";$(M+"color").css("background","url('images/none.png')");$(M+"opacity").html("N/A")}else{$(M+"color").css("background",color)}if(L.shiftKey){d.setStrokeColor(color);if(color!="none"&&$("#stroke_opacity").html()=="N/A"){d.setStrokeOpacity(1);$("#stroke_opacity").html("100 %")}}else{d.setFillColor(color);if(color!="none"&&$("#fill_opacity").html()=="N/A"){d.setFillOpacity(1);$("#fill_opacity").html("100 %")}}n()});var I=function(L){if($(L).hasClass("tool_button_disabled")){return false}$(".tools_flyout").fadeOut();$("#styleoverrides").text("");$(".tool_button_current").removeClass("tool_button_current").addClass("tool_button");$(L).addClass("tool_button_current");d.clearSelection();return true};var w=function(){if(I("#tool_select")){d.setMode("select");$("#styleoverrides").text("*{cursor:move;pointer-events:all} svg{cursor:default}")}};var m=function(){if(I("#tool_path")){d.setMode("path")}};var A=function(){if(I("#tool_line")){d.setMode("line")}};var D=function(){if(I("#tools_rect_show")){d.setMode("square")}$("#tools_rect_show").attr("src","images/square.png")};var e=function(){if(I("#tools_rect_show")){d.setMode("rect")}$("#tools_rect_show").attr("src","images/rect.png")};var g=function(){if(I("#tools_rect_show")){d.setMode("fhrect")}$("#tools_rect_show").attr("src","images/freehand-square.png")};var h=function(){if(I("#tools_ellipse_show")){d.setMode("circle")}$("#tools_ellipse_show").attr("src","images/circle.png")};var y=function(){if(I("#tools_ellipse_show")){d.setMode("ellipse")}$("#tools_ellipse_show").attr("src","images/ellipse.png")};var i=function(){if(I("#tools_ellipse_show")){d.setMode("fhellipse")}$("#tools_ellipse_show").attr("src","images/freehand-circle.png")};var f=function(){if(p!=null||J){d.deleteSelectedElements()}};var s=function(){if(p!=null){d.moveToTopSelectedElement()}};var o=function(){if(p!=null){d.moveToBottomSelectedElement()}};var z=function(M,L){if(p!=null||J){d.moveSelectedElement(M,L)}};var c=function(){I("#tool_text");d.setMode("text")};var v=function(){if(confirm("Do you want to clear the drawing?\nThis will also erase your undo history!")){d.clear();l()}};var u=function(){d.setBold(!d.getBold());l()};var k=function(){d.setItalic(!d.getItalic());l()};var K=function(){d.save()};var b=function(){if(d.getUndoStackSize()>0){d.undo()}};var E=function(){if(d.getRedoStackSize()>0){d.redo()}};$("#tool_select").click(w);$("#tool_path").click(m);$("#tool_line").click(A);$("#tool_square").mouseup(D);$("#tool_rect").mouseup(e);$("#tool_fhrect").mouseup(g);$("#tool_circle").mouseup(h);$("#tool_ellipse").mouseup(y);$("#tool_fhellipse").mouseup(i);$("#tool_text").click(c);$("#tool_clear").click(v);$("#tool_save").click(K);$("#tool_delete").click(f);$("#tool_delete_multi").click(f);$("#tool_move_top").click(s);$("#tool_move_bottom").click(o);$("#tool_undo").click(b);$("#tool_redo").click(E);$("#tools_rect_show").click(D);$("#tools_ellipse_show").click(h);$("#tool_bold").mousedown(u);$("#tool_italic").mousedown(k);$("#tool_clear").mousedown(function(){$("#tool_clear").addClass("tool_button_current")});$("#tool_clear").mouseup(function(){$("#tool_clear").removeClass("tool_button_current")});$("#tool_clear").mouseout(function(){$("#tool_clear").removeClass("tool_button_current")});$("#tool_save").mousedown(function(){$("#tool_save").addClass("tool_button_current")});$("#tool_save").mouseup(function(){$("#tool_save").removeClass("tool_button_current")});$("#tool_save").mouseout(function(){$("#tool_save").removeClass("tool_button_current")});$("#tool_delete").mousedown(function(){$("#tool_delete").addClass("tool_button_current")});$("#tool_delete").mouseup(function(){$("#tool_delete").removeClass("tool_button_current")});$("#tool_delete").mouseout(function(){$("#tool_delete").removeClass("tool_button_current")});$("#tool_delete_multi").mousedown(function(){$("#tool_delete_multi").addClass("tool_button_current")});$("#tool_delete_multi").mouseup(function(){$("#tool_delete_multi").removeClass("tool_button_current")});$("#tool_delete_multi").mouseout(function(){$("#tool_delete_multi").removeClass("tool_button_current")});$("#tool_undo").mousedown(function(){if(!$("#tool_undo").hasClass("tool_button_disabled")){$("#tool_undo").addClass("tool_button_current")}});$("#tool_undo").mouseup(function(){$("#tool_undo").removeClass("tool_button_current")});$("#tool_undo").mouseout(function(){$("#tool_undo").removeClass("tool_button_current")});$("#tool_redo").mousedown(function(){if(!$("#tool_redo").hasClass("tool_button_disabled")){$("#tool_redo").addClass("tool_button_current")}});$("#tool_redo").mouseup(function(){$("#tool_redo").removeClass("tool_button_current")});$("#tool_redo").mouseout(function(){$("#tool_redo").removeClass("tool_button_current")});$("#tool_move_top").mousedown(function(){$("#tool_move_top").addClass("tool_button_current")});$("#tool_move_top").mouseup(function(){$("#tool_move_top").removeClass("tool_button_current")});$("#tool_move_top").mouseout(function(){$("#tool_move_top").removeClass("tool_button_current")});$("#tool_move_bottom").mousedown(function(){$("#tool_move_bottom").addClass("tool_button_current")});$("#tool_move_bottom").mouseup(function(){$("#tool_move_bottom").removeClass("tool_button_current")});$("#tool_move_bottom").mouseout(function(){$("#tool_move_bottom").removeClass("tool_button_current")});$(document).bind("keydown",{combi:"1",disableInInput:true},w);$(document).bind("keydown",{combi:"2",disableInInput:true},m);$(document).bind("keydown",{combi:"3",disableInInput:true},A);$(document).bind("keydown",{combi:"Shift+4",disableInInput:true},D);$(document).bind("keydown",{combi:"4",disableInInput:true},e);$(document).bind("keydown",{combi:"Shift+5",disableInInput:true},h);$(document).bind("keydown",{combi:"5",disableInInput:true},y);$(document).bind("keydown",{combi:"6",disableInInput:true},c);$(document).bind("keydown",{combi:"N",disableInInput:true},v);$(document).bind("keydown",{combi:"S",disableInInput:true},K);$(document).bind("keydown",{combi:"del",disableInInput:true},function(L){f();L.preventDefault()});$(document).bind("keydown",{combi:"backspace",disableInInput:true},function(L){f();L.preventDefault()});$(document).bind("keydown",{combi:"shift+up",disableInInput:true},s);$(document).bind("keydown",{combi:"shift+down",disableInInput:true},o);$(document).bind("keydown",{combi:"up",disableInInput:true},function(L){z(0,-1);L.preventDefault()});$(document).bind("keydown",{combi:"down",disableInInput:true},function(L){z(0,1);L.preventDefault()});$(document).bind("keydown",{combi:"left",disableInInput:true},function(L){z(-1,0);L.preventDefault()});$(document).bind("keydown",{combi:"right",disableInInput:true},function(L){z(1,0);L.preventDefault()});$(document).bind("keydown",{combi:"z",disableInInput:true},b);$(document).bind("keydown",{combi:"shift+z",disableInInput:true},E);$(document).bind("keydown",{combi:"y",disableInInput:true},E);var G=function(P){var L=P.css("background");var M=P.css("background-color");var O="100 %";if(P.attr("id")=="stroke_color"){O=$("#stroke_opacity").html()}if(P.attr("id")=="fill_color"){O=$("#fill_opacity").html()}var R=false;if(M=="transparent"||M=="initial"){M=new $.jPicker.Color({hex:"ffffff",a:100});R=true}else{var Q;if(O=="N/A"){Q=100}else{Q=O.split(" ")[0]}if(M.length==7&&M[0]=="#"){M=new $.jPicker.Color({hex:M.substring(1,7),a:Q})}else{if(M.substring(0,4)=="rgb("&&M[M.length-1]==")"){var N=M.substring(4,M.length-1).split(",");M=new $.jPicker.Color({r:N[0],g:N[1],b:N[2],a:Q})}else{M=new $.jPicker.Color({hex:"ffffff",a:Q})}}}var S=P.position();picker="stroke";$("#color_picker").css({left:S.left-140,bottom:104-S.top}).jPicker({images:{clientPath:"jpicker/images/"},color:{active:M,alphaSupport:true}},function(T){P.css("background","#"+this.settings.color.active.hex);if(P.attr("id")=="stroke_color"){d.setStrokeColor("#"+this.settings.color.active.hex);d.setStrokeOpacity(this.settings.color.active.a/100);$("#stroke_opacity").html(this.settings.color.active.a+" %")}else{if(P.attr("id")=="fill_color"){d.setFillColor("#"+this.settings.color.active.hex);d.setFillOpacity(this.settings.color.active.a/100);$("#fill_opacity").html(this.settings.color.active.a+" %")}}$("#color_picker").hide()},null,function(){P.css("background",L);if(P.attr("id")=="stroke_color"){$("#stroke_opacity").html(O)}else{if(P.attr("id")=="fill_color"){$("#fill_opacity").html(O)}}if(R){if(P.attr("id")=="stroke_color"){d.setStrokeColor("none");$("#stroke_opacity").html("N/A")}else{if(P.attr("id")=="fill_color"){d.setFillColor("none");$("#fill_opacity").html("N/A")}}}$("#color_picker").hide()})};function n(){var L=(d.getFillColor()=="none");var M=(d.getStrokeColor()=="none");var P=["#tool_path","#tool_line"];var O=["#tools_rect_show","#tools_ellipse_show","#tool_text"];if(M){for(index in P){var N=P[index];if($(N).hasClass("tool_button_current")){w()}$(N).removeClass("tool_button").addClass("tool_button_disabled")}}else{for(index in P){var N=P[index];$(N).removeClass("tool_button_disabled").addClass("tool_button")}}if(M&&L){for(index in O){var N=O[index];if($(N).hasClass("tool_button_current")){w()}$(N).removeClass("tool_button").addClass("tool_button_disabled")}}else{for(index in O){var N=O[index];$(N).removeClass("tool_button_disabled").addClass("tool_button")}}}$("#fill_color").click(function(){G($(this));n()});$("#stroke_color").click(function(){G($(this));n()});$("#tools_rect_show").mousedown(function(L){$("#tools_rect").show();L.preventDefault()});$("#tools_rect").mouseleave(function(){$("#tools_rect").fadeOut()});$("#tools_ellipse_show").mousedown(function(L){$("#tools_ellipse").show();L.preventDefault()});$("#tools_ellipse").mouseleave(function(){$("#tools_ellipse").fadeOut()});$(".tool_flyout_button").mouseover(function(){$(this).addClass("tool_flyout_button_current")}).mouseout(function(){$(this).removeClass("tool_flyout_button_current")});function j(L,M){$("#resolution").val(L+"x"+M);$("#svgroot").css({width:L,height:M});$("#svgcanvas").css({width:L,height:M})}$("#resolution").change(function(){var M=this.value.split("x");var L=parseInt(M[0]),N=parseInt(M[1]);d.setResolution(L,N)});$("#rect_radius").SpinButton({min:0,max:1000,step:1,callback:q});$("#stroke_width").SpinButton({min:1,max:99,step:1,callback:F});return d};